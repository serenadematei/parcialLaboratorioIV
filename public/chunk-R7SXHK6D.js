import"./chunk-LJ4VENC6.js";import{b as _,c as i,d as L,e as M,f as F,g as I,h as D,i as A,j as O,k as j,n as z,o as T,p as V,q as B}from"./chunk-FJQILSXK.js";import{a as q}from"./chunk-4KHXCC4A.js";import{C as h,D as u,I as b,K as e,L as o,M as m,O as v,Q as s,W as S,aa as C,d as H,e as x,fa as R,ma as E,pa as y,qa as N,s as w,sa as P,ta as k}from"./chunk-FDKKDBFR.js";var a=H(q());var oe=(()=>{let c=class c{constructor(r,t,n,l){this.router=r,this.fb=t,this.auth=n,this.firestore=l,this.nombre="",this.password="",this.repetirPassword="",this.email="",this.selectedRole="",this.formRegister=this.fb.group({nombre:["",[i.pattern("^[a-zA-Z]+$"),i.minLength(2),i.maxLength(10)]],email:["",[i.pattern("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,}$"),i.minLength(2),i.maxLength(30)]],password:["",[i.min(5)]],repetirPassword:["",[i.min(5)]],selectedRole:["",[i.minLength(3),i.maxLength(20)]]})}onSubmit(){return x(this,null,function*(){if(this.formRegister.invalid)return;let r=this.formRegister.get("password"),t=this.formRegister.get("repetirPassword"),n=this.formRegister.get("selectedRole")?.value,{email:l,password:g,repetirPassword:p}=this.formRegister.value;if(g!==p){a.default.fire({icon:"error",title:"Error",text:"Las contrase\xF1as no coinciden. Por favor, intentelo denuevo"}).then(()=>{r&&p&&(r.reset(),p.reset())});return}if(!n){a.default.fire({icon:"error",title:"Perfil no seleccionado",text:"Debe seleccionar un perfil antes de registrarse."});return}try{if(yield this.auth.checkIfUserExists(l))a.default.fire({icon:"error",title:"Usuario existente",text:"El correo electr\xF3nico ya est\xE1 registrado. Inicie sesi\xF3n en lugar de registrarse."}).then(()=>{r&&t&&(r.reset(),t.reset())});else{let G=(yield this.auth.register(l,g,n)).user,Z=N(y(this.firestore,"users&role"),G.uid);yield P(Z,{mail:l,role:n},{merge:!0}),yield this.auth.login({email:l,password:g}),a.default.fire({icon:"success",title:"Registro exitoso",text:"\xA1Bienvenido!",confirmButtonText:"OK"}).then(()=>{this.router.navigate(["/home"])})}}catch(d){d.code==="auth/invalid-email"?a.default.fire({icon:"error",title:"Error en el correo electr\xF3nico",text:"El formato del correo electr\xF3nico es incorrecto. Por favor, verifique."}):d.code==="auth/weak-password"?a.default.fire({icon:"error",title:"Contrase\xF1a d\xE9bil",text:"La contrase\xF1a debe contener al menos 6 caracteres."}).then(()=>{r&&t&&(r.reset(),t.reset())}):d.code==="auth/email-already-in-use"?a.default.fire({icon:"error",title:"Correo electr\xF3nico en uso",text:"El correo electr\xF3nico ya est\xE1 registrado. Inicie sesi\xF3n en lugar de registrarse."}):(console.error("Error en el registro:",d),a.default.fire({icon:"error",title:"Error en el registro",text:"Hubo un error al registrar la cuenta. Por favor, verifique sus datos e intentelo denuevo."}).then(()=>{r&&t&&(r.reset(),t.reset())}))}})}goToLogin(){this.router.navigate(["/login"])}};c.\u0275fac=function(t){return new(t||c)(u(R),u(T),u(k),u(E))},c.\u0275cmp=w({type:c,selectors:[["app-registrarse"]],standalone:!0,features:[S],decls:35,vars:2,consts:[[1,"background-image"],[1,"vh-100","gradient-custom"],[1,"container","py-5","h-100"],[1,"row","d-flex","justify-content-center","align-items-center","h-100"],[1,"col-12","col-md-8","col-lg-6","col-xl-5"],[1,"card","bg-info","text-white","componente-color",2,"border-radius","0px"],[1,"card-body","p-5","text-center","componente-color"],[1,"mb-md-5","mt-md-4","pb-5"],[1,"fw-bold","mb-2","text-uppercase"],[1,"text-white-50","mb-5"],[3,"ngSubmit","formGroup"],["data-mdb-input-init","",1,"form-outline","form-white","mb-4"],["type","text","formControlName","nombre","maxlength","35","placeholder","Nombre","id","registerName",1,"form-control","form-control-lg",2,"text-align","center"],["type","email","formControlName","email","maxlength","35","placeholder","Email","id","registerEmail",1,"form-control","form-control-lg",2,"text-align","center"],["type","password","formControlName","password","maxlength","35","placeholder","Clave","id","registerPassword",1,"form-control","form-control-lg",2,"text-align","center"],["type","password","formControlName","repetirPassword","maxlength","35","placeholder","Repetir clave","id","registerRepeatPassword",1,"form-control","form-control-lg",2,"text-align","center"],[1,"mb-4"],["for","selectedRole",1,"form-label"],["id","selectedRole","formControlName","selectedRole",1,"form-select","form-select-lg"],["value","admin"],["value","empleado"],["type","submit","data-mdb-button-init","","data-mdb-ripple-init","",1,"btn","btn-outline-light","btn-lg","px-5","botones-color",3,"disabled"],[1,"mb-0"],[1,"btn","btn-link","text-white-50","fw-bold",3,"click"]],template:function(t,n){t&1&&(m(0,"div",0),e(1,"section",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"h2",8),s(9,"Registrarse"),o(),e(10,"p",9),s(11,"Ingrese sus datos"),o(),e(12,"form",10),v("ngSubmit",function(){return n.onSubmit()}),e(13,"div",11),m(14,"input",12),o(),e(15,"div",11),m(16,"input",13),o(),e(17,"div",11),m(18,"input",14),o(),e(19,"div",11),m(20,"input",15),o(),e(21,"div",16)(22,"label",17),s(23,"Seleccione su rol:"),o(),e(24,"select",18)(25,"option",19),s(26,"Administrador"),o(),e(27,"option",20),s(28,"Empleado"),o()()(),e(29,"button",21),s(30,"Registrarse"),o(),e(31,"p",22),s(32,"\xBFYa tienes una cuenta? "),e(33,"button",23),v("click",function(){return n.goToLogin()}),s(34,"Iniciar sesi\xF3n"),o()()()()()()()()()()),t&2&&(h(12),b("formGroup",n.formRegister),h(17),b("disabled",n.formRegister.invalid))},dependencies:[C,V,F,O,j,_,A,L,M,z,B,I,D],styles:['.background-image[_ngcontent-%COMP%]{position:fixed;z-index:-1;top:0;left:0;width:100%;height:100%;background-image:url("./media/fondo-NHIDQHN2.jpg");background-position:center top;background-repeat:no-repeat;background-size:cover}.botones-color[_ngcontent-%COMP%]{background-color:#f48fb1;border-color:#d03569}.botones-color[_ngcontent-%COMP%]:hover{background-color:#f06292;border-color:#d03569}.componente-color[_ngcontent-%COMP%]{background-color:#fa729f;border-color:#ac1e4d}']});let f=c;return f})();export{oe as RegistrarseComponent};
